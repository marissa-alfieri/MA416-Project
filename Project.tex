% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\documentclass[
]{article}
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amssymb}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Life Expectancy Trends (2000-2015)},
  pdfauthor={Marissa Alfieri, Jenny Zheng, Letitia Caspersen},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Life Expectancy Trends (2000-2015)}
\author{Marissa Alfieri, Jenny Zheng, Letitia Caspersen}
\date{2025-11-04}

\begin{document}
\maketitle

\subsection{Introduction}\label{introduction}

Life expectancy says a lot about how people live and the conditions they
face around the world. In this project, we wanted to look at how life
expectancy differs across continents and how it changes over time. We
started by checking whether continents already had different average
life expectancies in the year 2000. That way we could get a baseline
snapshot of global inequality. Then, we tested whether those differences
changed between 2000 and 2015 to see if countries have been getting
closer together or if the gap has stayed the same.

The main goal is to understand whether the differences in life
expectancy reflect ongoing global inequality or improvements that are
happening unevenly across regions.

The data come from Kaggle's Life Expectancy 2000--2015 dataset
(\url{https://www.kaggle.com/datasets/vrec99/life-expectancy-2000-2015}),
which combines information from the World Health Organization, World
Bank, and the United Nations. It includes 119 countries across 15 years,
with variables like GDP per capita, CO₂ emissions, health expenditure,
and internet access.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"Life\_Expectancy.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{quote}
\end{quote}

\subsection{Section 1 -- Comparing Continents in
2000}\label{section-1-comparing-continents-in-2000}

We wanted to start by establishing a baseline for global inequality in
life expectancy. To see whether people in some continents were living
longer than others at the start of the 21st century.

Our hypotheses were:

\begin{quote}
\(H_0: \text{The distributions of life expectancy are the same across all continents.}\)

\(H_a: \text{At least one continent differs.}\)
\end{quote}

\subsubsection{\texorpdfstring{\textbf{Checking The
Assumptions}}{Checking The Assumptions}}\label{checking-the-assumptions}

We planned to test this using a one-way ANOVA, so we first checked
whether the assumptions of normality and equal variances were met.

\begin{quote}
\mbox{}%
\paragraph{\texorpdfstring{\textbf{1.
Normality}}{1. Normality}}\label{normality}

\mbox{}%
\paragraph{}\label{section}
\end{quote}

Normality is important because ANOVA assumes that residuals within each
group are normally distributed.

\begin{quote}
\(\ H_0: \text{The life expectancy values within each continent are normally distributed.}\)

\(\ H_a: \text{The life expectancy values within at least one continent deviate from normality.}\)
\end{quote}

For normality, we visually inspected histograms of life expectancy for
each continent.

\pandocbounded{\includegraphics[keepaspectratio]{Project_files/figure-latex/unnamed-chunk-1-1.pdf}}

Visual inspection of the histograms suggested that the distributions
were varied, with some having approximately bell shaped curves, some
with unique distributions, and some skewed. To confirm normality
statistically, we used a Monte Carlo Anderson--Darling test.

This test measures how far the observed data deviates from what would be
expected under a normal distribution with the same mean and standard
deviation. Comparing our observed statistic to this simulated one let us
estimate the p-value and decide whether the normality assumption held.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123123}\NormalTok{)}
\NormalTok{nmc }\OtherTok{=} \DecValTok{10000}
\NormalTok{n }\OtherTok{=} \FunctionTok{length}\NormalTok{(x)}
\NormalTok{mc\_ad }\OtherTok{=} \FunctionTok{c}\NormalTok{()}

\CommentTok{\# observed statistic}
\NormalTok{x\_sorted }\OtherTok{=} \FunctionTok{sort}\NormalTok{(x)}
\NormalTok{F\_emp }\OtherTok{=}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{:}\NormalTok{n) }\SpecialCharTok{/}\NormalTok{ (n}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}
\NormalTok{F\_null }\OtherTok{=} \FunctionTok{pnorm}\NormalTok{(x\_sorted, }\FunctionTok{mean}\NormalTok{(x\_sorted), }\FunctionTok{sd}\NormalTok{(x\_sorted)) }
\NormalTok{AD\_obs }\OtherTok{=} \FunctionTok{sum}\NormalTok{(((}\FunctionTok{abs}\NormalTok{(F\_emp }\SpecialCharTok{{-}}\NormalTok{ F\_null))}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{/}\NormalTok{ (F\_emp }\SpecialCharTok{*}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ F\_emp)))}

\CommentTok{\# simulated normality}
\ControlFlowTok{for}\NormalTok{(k }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{nmc)\{}
\NormalTok{  smc }\OtherTok{=} \FunctionTok{sort}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(n, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\NormalTok{  F\_emp\_mc }\OtherTok{=}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{:}\NormalTok{n)}\SpecialCharTok{/}\NormalTok{(n}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}
\NormalTok{  F\_null\_mc }\OtherTok{=} \FunctionTok{pnorm}\NormalTok{(smc, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{  mc\_ad }\OtherTok{=} \FunctionTok{c}\NormalTok{(mc\_ad, }\FunctionTok{sum}\NormalTok{((F\_emp\_mc }\SpecialCharTok{{-}}\NormalTok{ F\_null\_mc)}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{/}\NormalTok{ (F\_emp\_mc }\SpecialCharTok{*}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ F\_emp\_mc))))}
\NormalTok{  \}}

\NormalTok{alpha }\OtherTok{=} \FloatTok{0.10}
\NormalTok{ad\_crit }\OtherTok{=} \FunctionTok{quantile}\NormalTok{(mc\_ad, }\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ alpha)}
\NormalTok{emp\_pval }\OtherTok{=} \FunctionTok{mean}\NormalTok{(mc\_ad }\SpecialCharTok{\textgreater{}=}\NormalTok{ AD\_obs)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Anderson–Darling Critical Value: 2
\end{verbatim}

\begin{verbatim}
## Empirical P-Value: 0
\end{verbatim}

The Anderson--Darling test gave an empirical p-value of 0.0004, which is
below the alpha level of 0.10. This means we reject the null hypothesis
of normality. So, the life expectancy data for 2000 aren't normally
distributed. This makes sense because some continents have much higher
averages while others are lower, so the data are naturally skewed
instead of bell-shaped. Before deciding how to move forward, we also
wanted to check whether the variability between groups was similar,
because large differences in spread can also affect ANOVA results.

\begin{quote}
\mbox{}%
\paragraph{\texorpdfstring{\textbf{2. Testing Equal
Variances}}{2. Testing Equal Variances}}\label{testing-equal-variances}

\mbox{}%
\paragraph{}\label{section-1}
\end{quote}

Equal variances (homoscedasticity) matter because ANOVA assumes that all
groups have about the same level of variability. If one continent's life
expectancy values are way more spread out than another's, the results
can be misleading.

\begin{quote}
\(\ H_0: \text{The variances of life expectancy among continents are equal.}\)

\(\ H_a: \text{At least one group’s variance differs.}\)
\end{quote}

We used the Bartlett statistic, which tests whether the variances of
life expectancy across groups (\(j\)) are equal. It compares each
group's sample variance (\(s_j^2\)) to the pooled variance (\(s_p^2\))
that would be expected if all groups had the same variability. The
Bartlett statistic (\(B_{\text{stat}}\)) is computed as:

\[
Bstat = \frac{v * ln(s_p^2) - (\sum_{j=1}^{g}v_j * ln(s_j^2) )}{1 + \frac{1}{3(g-1)}* [(\sum_{j=1}^{g} \frac{1}{v_j})- \frac{1}{v}]}
\]

First, we split the dataset by continent so that we could calculate each
group's mean, variance, and sample size:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{xs }\OtherTok{=} \FunctionTok{split}\NormalTok{(x, data\_2000}\SpecialCharTok{$}\NormalTok{Continent)}
\NormalTok{xbarj }\OtherTok{=} \FunctionTok{sapply}\NormalTok{(xs, mean)}
\NormalTok{s2j }\OtherTok{=} \FunctionTok{sapply}\NormalTok{(xs, var)}
\NormalTok{nj}\OtherTok{=} \FunctionTok{sapply}\NormalTok{ (xs, length)}
\end{Highlighting}
\end{Shaded}

Each continent's variance (\(s_j^2\)) represents how spread out its life
expectancy values are. Then we calculated each group's degrees of
freedom (\(v_j=n_j-1\)) and counted the number of groups (\(g\)):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vj}\OtherTok{=}\NormalTok{ nj}\DecValTok{{-}1}
\NormalTok{g}\OtherTok{=} \FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(data\_2000}\SpecialCharTok{$}\NormalTok{Continent))}
\end{Highlighting}
\end{Shaded}

Next, we computed the pooled variance, which combines the group
variances into a single weighted value based on their degrees of
freedom: \[
s_p^2=\frac{\sum_{j=1}^{g}v_js_j^2}{\sum_{j=1}^{g}v_j}
\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sp2 }\OtherTok{=} \FunctionTok{sum}\NormalTok{(vj }\SpecialCharTok{*}\NormalTok{ s2j)}\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(vj)}
\end{Highlighting}
\end{Shaded}

After defining the components for each continent (sample variance
\(s_j^2\), degrees of freedom \(v_j\), and the number of groups \(g\)),
we computed the Bartlett statistic:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bastat }\OtherTok{=}\NormalTok{ ((}\FunctionTok{sum}\NormalTok{(vj) }\SpecialCharTok{*} \FunctionTok{log}\NormalTok{(sp2)) }\SpecialCharTok{{-}} \FunctionTok{sum}\NormalTok{(vj }\SpecialCharTok{*} \FunctionTok{log}\NormalTok{(s2j)))}\SpecialCharTok{/}
\NormalTok{  (}\DecValTok{1}\SpecialCharTok{+} \DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{3}\SpecialCharTok{*}\NormalTok{(g}\DecValTok{{-}1}\NormalTok{))}\SpecialCharTok{*}\NormalTok{ (}\FunctionTok{sum}\NormalTok{(}\DecValTok{1}\SpecialCharTok{/}\NormalTok{vj)}\SpecialCharTok{{-}} \DecValTok{1}\SpecialCharTok{/}\FunctionTok{sum}\NormalTok{(vj)))}

\NormalTok{pval }\OtherTok{=} \FunctionTok{pchisq}\NormalTok{(bastat, g}\DecValTok{{-}1}\NormalTok{, }\AttributeTok{lower.tail=}\NormalTok{ F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Bartlett’s Test Statistic: 26.5106
\end{verbatim}

\begin{verbatim}
## Bartlett’s Test P-Value: 7.102463e-05
\end{verbatim}

The Bartlett's test returned a test statistic of 26.51 and a p-value of
0.0001, which is below the alpha level of 0.10. This means we reject the
null hypothesis and conclude that the variances of life expectancy are
not equal across continents. So, the spread of life expectancy values
differs depending on the region.

\begin{quote}
\end{quote}

\subsubsection{Welch's One-Factor ANOVA}\label{welchs-one-factor-anova}

\begin{quote}
\end{quote}

Because Bartlett's test indicated that the variances across continents
were not equal, we used Welch's ANOVA, which adjusts for unequal
variances and sample sizes. This version of ANOVA is more robust when
the homogeneity of variance assumption is violated.

\begin{quote}
\(H_0: \mu_{\text{Africa}} = \mu_{\text{Asia}} = \mu_{\text{Europe}} = \mu_{\text{North America}}= \mu_{\text{South America}}= \mu_{\text{Oceania}}\)

\(H_a: \text{At least one mean differs.}\)
\end{quote}

Welch's F statistic is calculated as:

\[F^* = \frac{\sum_{j=1}^{g} w_j (\bar{X}_j - \bar{X}_w)^2 / (g - 1)}{1 + \frac{2(g - 2)}{g^2 - 1} \sum_{j=1}^{g} \frac{(1 - w_j / \sum_{k=1}^{g} w_k)^2}{n_j - 1}}\]

where \(w_j = \frac{n_j}{s_j^2}\) are the weights for each group.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nj }\OtherTok{=} \FunctionTok{sapply}\NormalTok{(xs, length)}
\NormalTok{s2j }\OtherTok{=} \FunctionTok{sapply}\NormalTok{(xs, var)}
\NormalTok{wj }\OtherTok{=}\NormalTok{ nj}\SpecialCharTok{/}\NormalTok{s2j}
\NormalTok{xbarbar\_h }\OtherTok{=} \FunctionTok{sum}\NormalTok{(wj}\SpecialCharTok{*}\NormalTok{xbarj)}\SpecialCharTok{/}\FunctionTok{sum}\NormalTok{(wj)}
\NormalTok{g }\OtherTok{=} \FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(data\_2000}\SpecialCharTok{$}\NormalTok{Continent))}
\NormalTok{n }\OtherTok{=} \FunctionTok{length}\NormalTok{(x)}

\NormalTok{ssm\_h }\OtherTok{=} \FunctionTok{sum}\NormalTok{(wj}\SpecialCharTok{*}\NormalTok{(xbarj}\SpecialCharTok{{-}}\NormalTok{xbarbar\_h)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{msm\_h }\OtherTok{=}\NormalTok{ ssm\_h}\SpecialCharTok{/}\NormalTok{g}
\NormalTok{v\_h }\OtherTok{=}\NormalTok{ ((}\FunctionTok{sum}\NormalTok{(nj}\SpecialCharTok{/}\NormalTok{s2j))}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{/}\NormalTok{ (}\FunctionTok{sum}\NormalTok{((nj}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{/}\NormalTok{ (s2j}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{*}\NormalTok{ (nj }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{))))}

\NormalTok{Fstat\_h }\OtherTok{=}\NormalTok{ msm\_h}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\DecValTok{2} \SpecialCharTok{*}\NormalTok{ (g}\DecValTok{{-}2}\NormalTok{)}\SpecialCharTok{/}\NormalTok{v\_h)}
\NormalTok{p }\OtherTok{=} \FunctionTok{pf}\NormalTok{(Fstat\_h, g}\DecValTok{{-}1}\NormalTok{, v\_h, }\AttributeTok{lower.tail=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## F Statistic: 11.8083
\end{verbatim}

\begin{verbatim}
## P-Value: 0.06788656
\end{verbatim}

At an alpha level of 0.10, the p-value (0.0679) is slightly above the
cutoff. Therefore, we fail to reject the null hypothesis, meaning that
when adjusting for unequal variances, there is no statistically
significant difference in mean life expectancy across continents at the
10\% level.

However, since the data were not normally distributed (as shown by the
Anderson--Darling test), we could not fully rely on the results of
Welch's ANOVA.

\begin{quote}
\end{quote}

\subsubsection{\texorpdfstring{\textbf{Kruskal--Wallis
Test}}{Kruskal--Wallis Test}}\label{kruskalwallis-test}

\begin{quote}
\end{quote}

To confirm whether the previous conclusion holds, we used the
Kruskal--Wallis test, a non-parametric alternative that compares the
median ranks instead of the means.

The hypotheses are:

\begin{quote}
\(\ H_0: \text{The distributions of life expectancy are the same across all continents.}\)

\(H_a: \text{At least one continent differs.}\)
\end{quote}

We used the Kruskal--Wallis statistic, which tests whether the
distributions of life expectancy across groups (\(j\)) are the same. It
ranks all observations together, then compares the average rank within
each group (\(\bar{R}_j\)) to the overall mean rank (\(\bar{R}\)). If
the group ranks differ a lot, it suggests that at least one continent's
distribution is different. The Kruskal--Wallis statistic (\(H\)) is
computed as:

\[
H = \frac{12}{N(N + 1)} \sum_{j=1}^{g} n_j (\bar{R}_j - \bar{R})^2
\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{R\_all }\OtherTok{=} \FunctionTok{rank}\NormalTok{(}\FunctionTok{unlist}\NormalTok{(xs))}
\NormalTok{Rj }\OtherTok{=} \FunctionTok{split}\NormalTok{(R\_all, }\FunctionTok{rep}\NormalTok{(}\FunctionTok{names}\NormalTok{(xs), }\AttributeTok{times =} \FunctionTok{sapply}\NormalTok{(xs, length)))}
\NormalTok{nj }\OtherTok{=} \FunctionTok{sapply}\NormalTok{(Rj, length)}
\NormalTok{N }\OtherTok{=} \FunctionTok{sum}\NormalTok{(nj)}
\NormalTok{g }\OtherTok{=} \FunctionTok{length}\NormalTok{(Rj)}
\NormalTok{Rbar\_j }\OtherTok{=} \FunctionTok{sapply}\NormalTok{(Rj, mean)}
\NormalTok{Rbar }\OtherTok{=}\NormalTok{ (N }\SpecialCharTok{+} \DecValTok{1}\NormalTok{) }\SpecialCharTok{/} \DecValTok{2}

\NormalTok{H\_stat }\OtherTok{=}\NormalTok{ (}\DecValTok{12} \SpecialCharTok{/}\NormalTok{ (N }\SpecialCharTok{*}\NormalTok{ (N }\SpecialCharTok{+} \DecValTok{1}\NormalTok{))) }\SpecialCharTok{*} \FunctionTok{sum}\NormalTok{(nj }\SpecialCharTok{*}\NormalTok{ (Rbar\_j }\SpecialCharTok{{-}}\NormalTok{ Rbar)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{pval\_kw }\OtherTok{=} \FunctionTok{pchisq}\NormalTok{(H\_stat, g }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{, }\AttributeTok{lower.tail =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Kruskal–Wallis H Statistic: 65.0293
\end{verbatim}

\begin{verbatim}
## P-Value: 1.105162e-12
\end{verbatim}

The Kruskal--Wallis test returned an \(H\) statistic of 65.03 with a
p-value of 1.10 \textbf{×} 10⁻¹², which is below the alpha level of
0.10. This means we reject the null hypothesis and conclude that life
expectancy distributions differ significantly across continents in the
year 2000.

This confirmed that regional inequality in life expectancy was already
present at the start of the century.

\begin{quote}
\end{quote}

\subsection{Section 2 -- Comparing Continents from
2000-2015}\label{section-2-comparing-continents-from-2000-2015}

After finding that life expectancy differed across continents in 2000,
we wanted to see whether those differences changed over time. Did the
gap between regions decrease or have some continents continued to fall
behind? To figure that out, we looked at how the average life expectancy
changed from 2000 to 2015.

Our hypotheses were:

\begin{quote}
\(H_0: \mu_{\text{2000}} = \mu_{\text{2001}} = \mu_{\text{2002}} = \dots = \mu_{\text{2015}}\)

\(H_a: \text{At least one mean differs.}\)
\end{quote}

\subsubsection{\texorpdfstring{\textbf{Checking The
Assumptions}}{Checking The Assumptions}}\label{checking-the-assumptions-1}

We planned to test this using a repeated-measures ANOVA, so we first
checked whether the assumptions of normality, sphericity, and
independence were met.

\begin{quote}
\mbox{}%
\paragraph{\texorpdfstring{\textbf{1.
Normality}}{1. Normality}}\label{normality-1}

\mbox{}%
\paragraph{}\label{section-2}
\end{quote}

Normality is important because repeated-measures ANOVA assumes that the
residuals (or differences between time points) are roughly normally
distributed.

\[
\ H_0: \text{The life expectancy values across years are normally distributed.} \\
\ H_a: \text{The life expectancy values deviate from normality.}
\] To test this, we used the Kolmogorov--Smirnov test, which compares
the sample's cumulative distribution to a normal distribution with the
same mean and standard deviation.

The KS statistic (\(D\)) is computed as:

\[
D = \max \left| F_{\text{emp}}(x) - F_{\text{null}}(x) \right|
\]

In R, it was calculated as:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{=}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{Life.Expectancy}
\NormalTok{x\_sorted }\OtherTok{=} \FunctionTok{sort}\NormalTok{(x)}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123123}\NormalTok{)}
\NormalTok{nmc }\OtherTok{=} \DecValTok{10000}
\NormalTok{n }\OtherTok{=} \FunctionTok{length}\NormalTok{(x\_sorted)}

\CommentTok{\# observed statistic}
\NormalTok{F\_emp }\OtherTok{=}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{:}\NormalTok{n) }\SpecialCharTok{/}\NormalTok{ (n}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}
\NormalTok{F\_null }\OtherTok{=} \FunctionTok{pnorm}\NormalTok{(x\_sorted, }\FunctionTok{mean}\NormalTok{(x\_sorted), }\FunctionTok{sd}\NormalTok{(x\_sorted)) }
\NormalTok{KS\_obs }\OtherTok{=} \FunctionTok{max}\NormalTok{(}\FunctionTok{abs}\NormalTok{(F\_emp }\SpecialCharTok{{-}}\NormalTok{ F\_null))}

\CommentTok{\# simulated normality}
\NormalTok{KS\_mc }\OtherTok{=} \FunctionTok{c}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{(k }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{nmc)\{}
\NormalTok{  smc }\OtherTok{=} \FunctionTok{sort}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(n, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\NormalTok{  F\_emp\_mc }\OtherTok{=}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{:}\NormalTok{n) }\SpecialCharTok{/}\NormalTok{ (n}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}
\NormalTok{  F\_null\_mc }\OtherTok{=} \FunctionTok{pnorm}\NormalTok{(smc, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{  KS\_mc }\OtherTok{=} \FunctionTok{c}\NormalTok{(KS\_mc, }\FunctionTok{max}\NormalTok{(}\FunctionTok{abs}\NormalTok{(F\_emp\_mc }\SpecialCharTok{{-}}\NormalTok{ F\_null\_mc)))}
\NormalTok{  \}}

\NormalTok{alpha }\OtherTok{=} \FloatTok{0.10}
\NormalTok{KS\_crit }\OtherTok{=} \FunctionTok{quantile}\NormalTok{(KS\_mc, }\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ alpha)}
\NormalTok{emp\_pval }\OtherTok{=} \FunctionTok{mean}\NormalTok{(KS\_mc }\SpecialCharTok{\textgreater{}=}\NormalTok{ KS\_obs)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Kolmogorov–Smirnov Critical Value: 0.02790051
\end{verbatim}

\begin{verbatim}
## Empirical P-Value: 0
\end{verbatim}

The Kolmogorov--Smirnov test gave a critical value of 0.0279 and an
empirical p-value of 0, which is below the alpha level of 0.10. This
means we reject the null hypothesis of normality. So, the life
expectancy values across years aren't normally distributed. Before
deciding how to move forward, we also wanted to check the assumption of
sphericity, which deals with the relationships between repeated
measurements over time.

\begin{quote}
\mbox{}%
\paragraph{\texorpdfstring{\textbf{2.
Sphericity}}{2. Sphericity}}\label{sphericity}
\end{quote}

Sphericity is the repeated-measures version of equal variances. It
assumes that the variances of the differences between every pair of
years are roughly equal.

\[
\ H_0: \text{The variances of the differences between all pairs of years are equal.} \\
\ H_a: \text{At least one pair of years differs in variance of differences.}
\]

We computed Mauchly's test to evaluate the sphericity assumption. This
test measures whether the covariance matrix of repeated measures is
close to spherical.

The Mauchly statistic (\(W\)) is calculated as: \[
W = \frac{|\Sigma|}{\left( \frac{\text{tr}(\Sigma)}{k} \right)^k}
\]

where \(|\Sigma|\) is the determinant of the covariance matrix and
\(\text{tr}(\Sigma)\) is its trace.

The test statistic (\(M_{\text{stat}}\) ) is then computed as:

\[
M_{\text{stat}} = -(n - 1) \ln(W)
\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{k }\OtherTok{=} \FunctionTok{ncol}\NormalTok{(x)}
\NormalTok{n }\OtherTok{=} \FunctionTok{nrow}\NormalTok{(x)}
\NormalTok{c }\OtherTok{=} \FunctionTok{cov}\NormalTok{(x)}
\NormalTok{tr }\OtherTok{=} \FunctionTok{sum}\NormalTok{(}\FunctionTok{diag}\NormalTok{(c))}
\NormalTok{det }\OtherTok{=} \FunctionTok{det}\NormalTok{(c)}

\NormalTok{W }\OtherTok{=}\NormalTok{ det }\SpecialCharTok{/}\NormalTok{ ((tr }\SpecialCharTok{/}\NormalTok{ k)}\SpecialCharTok{\^{}}\NormalTok{k)}
\NormalTok{Mstat }\OtherTok{=} \SpecialCharTok{{-}}\NormalTok{(n}\DecValTok{{-}1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{log}\NormalTok{(W) }
\NormalTok{df }\OtherTok{=}\NormalTok{ (k}\SpecialCharTok{*}\NormalTok{(k}\DecValTok{{-}1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{2}\NormalTok{)}
\NormalTok{Mcrit }\OtherTok{=} \FunctionTok{qchisq}\NormalTok{(}\DecValTok{1}\FloatTok{{-}0.10}\NormalTok{, df)}
\NormalTok{Mpval }\OtherTok{=} \FunctionTok{pchisq}\NormalTok{(Mstat, df,}\AttributeTok{lower.tail =}\NormalTok{ F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Mauchly's Test Statistic: 2119.985
\end{verbatim}

\begin{verbatim}
## Mauchly's Test P-Value: 0
\end{verbatim}

The Mauchly's test of sphericity returned a test statistic of
\textbf{2119.99} and a p-value of \textbf{0}, which is below the alpha
level of 0.10. This means we reject the null hypothesis of sphericity.
So, the variances of the differences between years are not equal,
meaning that the correlations between time points vary.

\begin{quote}
\end{quote}

\textbf{Non-Spherical Repeated-Measures ANOVA}

\begin{quote}
\end{quote}

Since Mauchly's test showed that the data violated sphericity, we used
the Greenhouse--Geisser correction to adjust the repeated-measures
ANOVA. This correction adjusts the degrees of freedom to make the test
more accurate when the relationships between time points aren't
perfectly equal.

\begin{quote}
\(H_0: \mu_{\text{2000}} = \mu_{\text{2001}} = \mu_{\text{2002}} = \dots = \mu_{\text{2015}}\)

\(H_a: \text{At least one mean differs.}\)
\end{quote}

The corrected F statistic is calculated as:

\[
F = \frac{MS_{\text{Year}}}{MS_{\text{Error(Year)}}}
\]

but both degrees of freedom are multiplied by the Greenhouse--Geisser
epsilon (\(\varepsilon_{GG}\)):

\[
df_1^{*} = \varepsilon_{GG}(k - 1), \quad df_2^{*} = \varepsilon_{GG}(k - 1)(n - 1)
\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{xbarj }\OtherTok{=} \FunctionTok{colMeans}\NormalTok{(x)}
\NormalTok{xbari }\OtherTok{=} \FunctionTok{rowMeans}\NormalTok{(x)}
\NormalTok{xbarbar }\OtherTok{=} \FunctionTok{mean}\NormalTok{(x)}
\NormalTok{s2all }\OtherTok{=} \FunctionTok{var}\NormalTok{(x)}
  
\NormalTok{n }\OtherTok{=} \FunctionTok{nrow}\NormalTok{(x)}
\NormalTok{g }\OtherTok{=} \FunctionTok{ncol}\NormalTok{(x)}
\NormalTok{Y }\OtherTok{=}\NormalTok{ x }\SpecialCharTok{{-}} \FunctionTok{rowMeans}\NormalTok{(x)}
\NormalTok{c }\OtherTok{=} \FunctionTok{cov}\NormalTok{(Y)           }
  
\NormalTok{SSM }\OtherTok{=}\NormalTok{ n}\SpecialCharTok{*}\FunctionTok{sum}\NormalTok{((xbarj }\SpecialCharTok{{-}}\NormalTok{ xbarbar)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{E }\OtherTok{=}\NormalTok{ x }\SpecialCharTok{{-}}\NormalTok{ xbari }\SpecialCharTok{{-}} \FunctionTok{matrix}\NormalTok{(xbarj, n, g, }\AttributeTok{byrow=}\NormalTok{T) }\SpecialCharTok{+}\NormalTok{ xbarbar}
\NormalTok{SSE }\OtherTok{=} \FunctionTok{sum}\NormalTok{(E}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{Fstat }\OtherTok{=}\NormalTok{ (SSM}\SpecialCharTok{/}\NormalTok{(g}\DecValTok{{-}1}\NormalTok{))}\SpecialCharTok{/}\NormalTok{(SSE}\SpecialCharTok{/}\NormalTok{((n}\DecValTok{{-}1}\NormalTok{)}\SpecialCharTok{*}\NormalTok{(g}\DecValTok{{-}1}\NormalTok{)))}

\CommentTok{\# Greenhouse{-}Geisser Correction}
\NormalTok{eps\_GG }\OtherTok{=}\NormalTok{ ((}\FunctionTok{sum}\NormalTok{(}\FunctionTok{diag}\NormalTok{(c)))}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{/}\NormalTok{ ((g }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{sum}\NormalTok{(c}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{))}
\NormalTok{df1\_GG }\OtherTok{=}\NormalTok{ eps\_GG }\SpecialCharTok{*}\NormalTok{ (g }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)}
\NormalTok{df2\_GG }\OtherTok{=}\NormalTok{ eps\_GG }\SpecialCharTok{*}\NormalTok{ (g }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{*}\NormalTok{ (n }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)}

\NormalTok{p\_GG }\OtherTok{=} \FunctionTok{pf}\NormalTok{(Fstat, df1\_GG, df2\_GG, }\AttributeTok{lower.tail =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"F Statistic:"}\NormalTok{, Fstat, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## F Statistic: 22.95869
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"P{-}Value:"}\NormalTok{, p\_GG, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## P-Value: 0.004653024
\end{verbatim}

After applying the correction, the results showed a significant main
effect of year, \emph{p} = 0.0047. This means we reject the null
hypothesis and conclude that mean life expectancy differed across at
least some years between 2000 and 2015.

\begin{quote}
\end{quote}

\subsubsection{\texorpdfstring{\textbf{Bootstrap Confidence
Interval}}{Bootstrap Confidence Interval}}\label{bootstrap-confidence-interval}

Since the Kolmogorov--Smirnov test showed that the data were not
normally distributed, we can't fully rely on the repeated-measures ANOVA
results. So, we used a bootstrap confidence interval to check whether
mean life expectancy changed between 2000 and 2015.

By resampling the data 10,000 times and recalculating the mean
difference each time, the bootstrap method builds an empirical
distribution of possible mean changes. This lets us estimate a
confidence interval without assuming that the data are normal.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123123}\NormalTok{)}
\NormalTok{data\_2000 }\OtherTok{=} \FunctionTok{subset}\NormalTok{(data, Year }\SpecialCharTok{==} \DecValTok{2000}\NormalTok{)}\SpecialCharTok{$}\NormalTok{Life.Expectancy}
\NormalTok{data\_2015 }\OtherTok{=} \FunctionTok{subset}\NormalTok{(data, Year }\SpecialCharTok{==} \DecValTok{2015}\NormalTok{)}\SpecialCharTok{$}\NormalTok{Life.Expectancy}
\NormalTok{obs\_diff }\OtherTok{=} \FunctionTok{mean}\NormalTok{(data\_2015) }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(data\_2000)}

\NormalTok{nboot }\OtherTok{=} \DecValTok{10000}
\NormalTok{boot\_diffs }\OtherTok{=} \FunctionTok{c}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{nboot) \{}
\NormalTok{  s1 }\OtherTok{=} \FunctionTok{sample}\NormalTok{(data\_2000, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  s2 }\OtherTok{=} \FunctionTok{sample}\NormalTok{(data\_2015, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  boot\_diffs[i] }\OtherTok{=} \FunctionTok{mean}\NormalTok{(s2) }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(s1)}
\NormalTok{\}}

\NormalTok{alpha }\OtherTok{=} \FloatTok{0.10}
\NormalTok{ci\_lower }\OtherTok{=} \FunctionTok{quantile}\NormalTok{(boot\_diffs, alpha }\SpecialCharTok{/} \DecValTok{2}\NormalTok{)}
\NormalTok{ci\_upper }\OtherTok{=} \FunctionTok{quantile}\NormalTok{(boot\_diffs, }\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ alpha }\SpecialCharTok{/} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"Bootstrap CI:"}\NormalTok{, ci\_lower, }\StringTok{"to"}\NormalTok{, ci\_upper, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Bootstrap CI: 3.157008 to 6.605049
\end{verbatim}

The bootstrap interval ranged from 3.16 to 6.61 years, which excludes 0,
confirming that mean life expectancy differed significantly between 2000
and 2015.

\begin{quote}
\end{quote}

\subsection{Section 3 -- Life Expectancy and CO2
Emissions}\label{section-3-life-expectancy-and-co2-emissions}

After examining differences across continents and changes over time, we
wanted to understand what factors might influence life expectancy. CO₂
emissions can serve as an indicator of industrial development, which
typically brings better infrastructure and healthcare. We used bootstrap
regression to estimate the relationship between CO₂ emissions and life
expectancy.

Our hypotheses were:

\[
H_0: \beta_1 = 0 \text{ (no relationship between CO₂ and life expectancy)} \\
H_a: \beta_1 \neq 0 \text{ (a relationship exists)}
\]

\subsubsection{\texorpdfstring{\textbf{Data}}{Data}}\label{data}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{CO2\_data }\OtherTok{=}\NormalTok{ data[, }\DecValTok{6}\NormalTok{]    }
\NormalTok{Life\_data }\OtherTok{=}\NormalTok{ data[, }\DecValTok{4}\NormalTok{]  }
\NormalTok{valid }\OtherTok{=} \FunctionTok{is.finite}\NormalTok{(CO2\_data) }\SpecialCharTok{\&} \FunctionTok{is.finite}\NormalTok{(Life\_data)}
\NormalTok{CO2\_clean }\OtherTok{=}\NormalTok{ CO2\_data[valid]}
\NormalTok{Life\_clean }\OtherTok{=}\NormalTok{ Life\_data[valid]}

\FunctionTok{plot}\NormalTok{(CO2\_clean, Life\_clean,}
     \AttributeTok{xlab =} \StringTok{"CO2 Emissions (metric tons per capita)"}\NormalTok{,}
     \AttributeTok{ylab =} \StringTok{"Life Expectancy (years)"}\NormalTok{,}
     \AttributeTok{main =} \StringTok{"Life Expectancy vs. CO2 Emissions"}\NormalTok{,}
     \AttributeTok{pch =} \DecValTok{16}\NormalTok{,}
     \AttributeTok{col =} \FunctionTok{rgb}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\FloatTok{0.3}\NormalTok{),}
     \AttributeTok{cex =} \FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{Project_files/figure-latex/s3.plot-1.pdf}}

\subsubsection{\texorpdfstring{\textbf{Bootstrap Confidence
Intervals}}{Bootstrap Confidence Intervals}}\label{bootstrap-confidence-intervals}

We used bootstrap resampling to construct confidence intervals for the
regression coefficients. This non-parametric method does not assume
normality of residuals.

For a linear regression model:

\[
\hat{y} = \beta_0 + \beta_1 x
\] \[
\beta_1 = r_{xy} \cdot \frac{s_y}{s_x} \quad \text{and} \quad \beta_0 = \bar{y} - \beta_1 \bar{x}
\]

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\NormalTok{nboot }\OtherTok{=} \DecValTok{10000}

\NormalTok{X }\OtherTok{=}\NormalTok{ CO2\_clean}
\NormalTok{Y }\OtherTok{=}\NormalTok{ Life\_clean}
\NormalTok{n }\OtherTok{=} \FunctionTok{length}\NormalTok{(X)}

\NormalTok{mybhat1 }\OtherTok{=} \FunctionTok{c}\NormalTok{()}
\NormalTok{mybhat0 }\OtherTok{=} \FunctionTok{c}\NormalTok{()}

\NormalTok{myindex }\OtherTok{=} \FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, n, }\DecValTok{1}\NormalTok{)}

\ControlFlowTok{for}\NormalTok{(k }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{nboot)\{}
\NormalTok{  sboot }\OtherTok{=} \FunctionTok{sample}\NormalTok{(myindex, n, }\AttributeTok{replace =}\NormalTok{ T)}
\NormalTok{  Xboot }\OtherTok{=}\NormalTok{ X[sboot]}
\NormalTok{  Yboot }\OtherTok{=}\NormalTok{ Y[sboot]}
  
\NormalTok{  bhat1 }\OtherTok{=} \FunctionTok{cor}\NormalTok{(Xboot, Yboot) }\SpecialCharTok{*} \FunctionTok{sd}\NormalTok{(Yboot) }\SpecialCharTok{/} \FunctionTok{sd}\NormalTok{(Xboot)}
\NormalTok{  bhat0 }\OtherTok{=} \FunctionTok{mean}\NormalTok{(Yboot) }\SpecialCharTok{{-}}\NormalTok{ bhat1 }\SpecialCharTok{*} \FunctionTok{mean}\NormalTok{(Xboot)}
  
\NormalTok{  mybhat1 }\OtherTok{=} \FunctionTok{c}\NormalTok{(mybhat1, bhat1)}
\NormalTok{  mybhat0 }\OtherTok{=} \FunctionTok{c}\NormalTok{(mybhat0, bhat0)}
\NormalTok{\}}

\NormalTok{alpha }\OtherTok{=} \FloatTok{0.10}
\NormalTok{cibhat1 }\OtherTok{=} \FunctionTok{quantile}\NormalTok{(mybhat1, }\FunctionTok{c}\NormalTok{(alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{, }\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{))}
\NormalTok{cibhat0 }\OtherTok{=} \FunctionTok{quantile}\NormalTok{(mybhat0, }\FunctionTok{c}\NormalTok{(alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{, }\DecValTok{1}\SpecialCharTok{{-}}\NormalTok{alpha}\SpecialCharTok{/}\DecValTok{2}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 90% Confidence Interval for Slope (β₁):
\end{verbatim}

\begin{verbatim}
##   [ 0.5708 , 0.7029 ]
\end{verbatim}

\begin{verbatim}
## 90% Confidence Interval for Intercept (β₀):
\end{verbatim}

\begin{verbatim}
##   [ 66.9412 , 67.8827 ]
\end{verbatim}

\subsubsection{\texorpdfstring{\textbf{Bootstrap
Distributions}}{Bootstrap Distributions}}\label{bootstrap-distributions}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{))}

\FunctionTok{hist}\NormalTok{(mybhat1, }
     \AttributeTok{breaks =} \DecValTok{30}\NormalTok{, }
     \AttributeTok{col =} \StringTok{"steelblue"}\NormalTok{,}
     \AttributeTok{main =} \StringTok{"Bootstrap Distribution of Slope"}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{"Slope (β₁)"}\NormalTok{,}
     \AttributeTok{ylab =} \StringTok{"Frequency"}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =}\NormalTok{ cibhat1, }\AttributeTok{col =} \StringTok{"red"}\NormalTok{, }\AttributeTok{lwd =} \DecValTok{2}\NormalTok{, }\AttributeTok{lty =} \DecValTok{2}\NormalTok{)}

\FunctionTok{hist}\NormalTok{(mybhat0, }
     \AttributeTok{breaks =} \DecValTok{30}\NormalTok{, }
     \AttributeTok{col =} \StringTok{"seagreen"}\NormalTok{,}
     \AttributeTok{main =} \StringTok{"Bootstrap Distribution of Intercept"}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{"Intercept (β₀)"}\NormalTok{,}
     \AttributeTok{ylab =} \StringTok{"Frequency"}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v =}\NormalTok{ cibhat0, }\AttributeTok{col =} \StringTok{"red"}\NormalTok{, }\AttributeTok{lwd =} \DecValTok{2}\NormalTok{, }\AttributeTok{lty =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{Project_files/figure-latex/s3.histograms-1.pdf}}

The histograms show the distributions of 10,000 bootstrap estimates. The
red dashed lines indicate the 90\% confidence interval bounds.

The 90\% confidence interval for the slope does not contain zero,
indicating a statistically significant positive relationship between CO₂
emissions and life expectancy. Countries with higher CO₂ emissions tend
to have longer life expectancies, likely because emissions correlate
with industrial development, which brings better healthcare
infrastructure and living standards.

\end{document}
